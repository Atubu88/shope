<div class="row g-3 align-items-stretch">
  {% for product in products %}
    <div class="col-6 col-md-4 col-lg-3 d-flex">
      <div class="card flex-fill border-0 shadow-sm product-card d-flex flex-column">

        <div class="p-3">
          <div class="ratio ratio-1x1 product-img-frame">
            {% if product.image %}
              <img loading="lazy" src="{{ product.image }}" alt="{{ product.name }}" class="product-img">
            {% else %}
              <div class="product-img-placeholder d-flex align-items-center justify-content-center text-muted">
                <span class="small">Нет фото</span>
              </div>
            {% endif %}
          </div>
        </div>

        <div class="card-body text-center d-flex flex-column p-2">
          <h6 class="card-title mb-2 product-title">
            <a href="/{{ salon_slug }}/product/{{ product.id }}" class="text-decoration-none text-dark">
              {{ product.name }}
            </a>
          </h6>

          <p class="fw-bold mb-2 price">
            {{ "%.2f"|format(product.price) }} ₽
          </p>

          <button
              class="btn btn-sm btn-primary mt-auto"
              hx-post="/{{ salon_slug }}/cart/add/{{ product.id }}"
              hx-trigger="click"
              hx-swap="none">
            Добавить в корзину
          </button>
        </div>

      </div>
    </div>
  {% endfor %}
</div>

<style>
  .product-card {
    transition: transform .2s ease, box-shadow .2s ease;
    border-radius: 1rem; overflow: hidden;
  }
  .product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 16px rgba(0,0,0,.15);
  }

  /* Картинка — квадрат 1:1 со скруглениями, одинаковая высота у всех */
  .product-img-frame { border-radius: 12px; overflow: hidden; background: #f8f9fa; }
  .product-img { width: 100%; height: 100%; object-fit: cover; display: block; }
  .product-img-placeholder { width: 100%; height: 100%; }

  /* Заголовок — максимум 2 строки, фиксированная высота */
  .product-title {
    font-size: .95rem;
    line-height: 1.2;
    display: -webkit-box;
    -webkit-line-clamp: 2;          /* ограничение в 2 строки */
    -webkit-box-orient: vertical;
    overflow: hidden;
    min-height: calc(1.2em * 2);    /* резерв под 2 строки */
    margin-bottom: .5rem;
  }

  .price { font-size: .9rem; }
</style>
