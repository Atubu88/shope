<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600&display=swap" rel="stylesheet">
    <!-- htmx -->
    <script src="https://unpkg.com/htmx.org@1.8.4"></script>

       <!-- Telegram WebApp API -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
      Telegram.WebApp.ready();
    </script>

    <style>
      .salon-name {
        font-family: 'Cormorant Garamond', serif;
        font-size: 1.6rem;
        font-weight: 600;
        letter-spacing: 1px;
        color: #f8f9fa !important;
        text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
      }

      /* —à–∏—Ä–∏–Ω–∞ sidebar */
      .offcanvas-start {
        width: 50% !important;   /* –ø–æ–ª–æ–≤–∏–Ω–∞ —ç–∫—Ä–∞–Ω–∞ */
        max-width: 400px;        /* –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
      }
    </style>
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-dark mb-4">
  <div class="container d-flex justify-content-between align-items-center">

    <!-- –ì–∞–º–±—É—Ä–≥–µ—Ä -->
    <button class="btn btn-outline-light me-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu">
      ‚ò∞
    </button>

    <!-- –ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–ª–æ–Ω–∞ -->
    <a class="navbar-brand salon-name" href="/{{ salon_slug }}/">
      {{ salon_name or "–ú–æ–π —Å–∞–ª–æ–Ω" }}
    </a>

    <!-- –ö–Ω–æ–ø–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
    <a href="/{{ salon_slug }}/cart"
       class="btn btn-outline-light position-relative">
      üõí –ö–æ—Ä–∑–∏–Ω–∞
      <span id="cart-count"
            class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
        {{ cart_count or 0 }}
      </span>
    </a>
  </div>
</nav>

<!-- Sidebar (Offcanvas) -->
<div class="offcanvas offcanvas-start bg-dark text-white" tabindex="-1" id="sidebarMenu" aria-labelledby="sidebarMenuLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="sidebarMenuLabel">{{ salon_name or "–ú–µ–Ω—é" }}</h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
  </div>
  <div class="offcanvas-body">
    <ul class="list-unstyled">
      <li><a href="/{{ salon_slug }}/" class="text-white text-decoration-none d-block py-2">üè† –ì–ª–∞–≤–Ω–∞—è</a></li>
      <li><a href="/{{ salon_slug }}/catalog" class="text-white text-decoration-none d-block py-2">üõç –ö–∞—Ç–∞–ª–æ–≥</a></li>
      <li><a href="/{{ salon_slug }}/services" class="text-white text-decoration-none d-block py-2">üíá –£—Å–ª—É–≥–∏</a></li>
      <li><a href="/{{ salon_slug }}/contacts" class="text-white text-decoration-none d-block py-2">üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
    </ul>
  </div>
</div>

<div class="container">

    <!-- Debug-banner -->
    <div class="alert alert-secondary py-2 mb-3" role="alert" style="border-radius:10px;">
      –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <strong>{{ welcome_name or 'none' }}</strong> ‚Äî –≤—ã –≤ —Å–∞–ª–æ–Ω–µ:
      <strong>{{ salon_name or 'none' }}</strong> (slug: <code>{{ salon_slug or 'none' }}</code>)
    </div>

    {% if not user_payload and BOT_USERNAME %}
    <div class="mb-3">
      <script async src="https://telegram.org/js/telegram-widget.js?22"
              data-telegram-login="{{ BOT_USERNAME }}"
              data-size="medium"
              data-onauth="onTelegramAuth(user)"
              data-request-access="write"></script>
      <script>
        function onTelegramAuth(user) {
          const data = {
            user: JSON.stringify({
              id: user.id,
              first_name: user.first_name,
              last_name: user.last_name,
              username: user.username,
              photo_url: user.photo_url
            }),
            auth_date: user.auth_date,
            hash: user.hash
          };
          const qs = new URLSearchParams(data).toString();
          const url = new URL(window.location.href);
          url.searchParams.set('init_data', qs);
          window.location.href = url.toString();
        }
      </script>
    </div>
    {% endif %}

    {% block content %}{% endblock %}
</div>

<!-- –ü–ª–∞–≤–∞—é—â–∞—è –∫–æ—Ä–∑–∏–Ω–∞ -->
<div id="floating-cart"
     class="position-fixed bottom-0 end-0 m-3 p-2 bg-dark text-white rounded shadow">
  üõí <span id="cart-count-floating">{{ cart_count or 0 }}</span>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
